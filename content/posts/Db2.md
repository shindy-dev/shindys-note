---
title: Db2
created: 2025-08-15
date: 2025-08-15T23:19:55
author: shindy
tags:
  - IBM
  - Db2
draft: "false"
---
## はじめに
IBMのDb2でよく使うコマンドや注意点を記載します。

## よく使うコマンド
### ライセンス確認
```bash
db2licm -l
```
### バージョン・bit数
```bash
db2level
```
### バックアップファイル情報確認
```bash
db2ckbkp -h [backup image]
```

<div style="page-break-after: always; margin: 0; padding: 0;"><hr class="pagebreak" style="margin: 0; padding: 0;"></div>

## Db2のバージョン移行等での注意
Db2バージョンが大きく異なると、別のバージョンを経由して移行（リストア）する必要がある。  
9系から11.5系、10系から12系等が該当する。

### 今回の事例
- 移行**元** DB2: v9.7 32bit
- 移行**先** DB2: v11.5 64bit
- バックアップファイル: オンライン、圧縮
### 問題点
1. オンラインバックアップだとバージョン間でのリストアができない
2. オフラインでも v9.7 から v11.5 へ直接のリストアはできない
3. 圧縮バックアップの場合、構成bit数が異なるDB2ではリストアできない
### 解決策
1. 一度v9.7でリストアし、オフラインバックアップを取得する
2. v9.7 -> v11.1.4(10.xでも可) -> 11.5 の順にリストアバックアップを行う
3. v9.7(32bit) -> v9.7(64bit)の順にリストアバックアップを行う
### 手順
1. v9.7(32bit)
   リストア、オフラインバックアップ無圧縮を取得
2. -> v9.7(64bit)
   リストア、オフラインバックアップ圧縮を取得
3. -> v11.1.4
   リストア、オフラインバックアップ圧縮を取得
4. -> v11.5
   リストア、完了！
### 注意
1. 11.5.4の場合のみ移行後runstatsで不具合がでるためdb2catを実行する必要がある


***So everyone, enjoy life!***